---
load: post
title: js笔记第四天
date: 2018-01-10
header-img: img/post-bg-desk.jpg
catalog: true
tags: JavaScript
---

## Math

```js
Math.sqrt();//开方
Math.pow();//幂次方
Math.ads();//绝对值
Math.floor();//向下取整
Math.ceil();//向上取整
Math.round();//四舍五入
Math.random();// 随机数
Math.min();//取最小值
Math.max();//取最大值
```

```js
//取m~n之间的随机数
Math.random()*(n-m)+m;
```

```js
// 从5~68之间随机4个整数
var arr = [];
while (arr.length < 4) {
  var temp = Math.round(Math.random() * 63 + 5);
  if (arr.indexOf(temp) === -1) {// 判断元素是否存在
    arr[arr.length] = temp;// 比push效率更高
  }
}
console.log(arr);
```

## DOM Document Object Model

浏览器渲染页面时，会把页面所有内容渲染成有层次关系的DOM节点。

一个页面的**根节点**只有一个`document`，一个页面的**根元素**只有一个:`html`.

一个页面有如下节点组成：**文档节点**，**元素节点**，**注释节点**，**文本节点**.

| NodeType | NodeName    | NodeValue |      |
| -------- | ----------- | --------- | ---- |
| 9        | `#document` | `null`    | 文档节点 |
| 1        | 大写的标记名      | `null`    | 元素节点 |
| 8        | `#comment`  | 注释内容      | 注释节点 |
| 3        | `#text`     | 文本内容      | 文本节点 |

### 表示节点之间相互关系的属性

`parentNode` 父节点（都是元素节点）

`childNodes`	获取所有的子节点

`children`	获取所有的子元素节点（IE不兼容）

`firstChild`	获取第一个子节点

`firstElementChild` 	获取第一个子元素节点

`lastChild`	获取最后一个子节点

`lastElementChild` 获取最后一个子元素节点

`previousSibling` 哥哥节点

`previousElementSilbing` 哥哥元素节点

`nextSibling` 	弟弟节点

`nextElementSibling`	弟弟元素节点

>   所有的元素节点 IE8 及以下都不兼容

### js 获取元素总结

-   id ->`document.getElementById('div1')` 只有一个
-   tagName ->`context.getElementsByTagName('li') `是一个集合，是一组元素
-   className ->`context.getElementsByClassName('a1 a2')`是一个集合,一组元素，IE9以下的版本不支持`document.getElementsByClassName`方法
-   name ->`context.getElementsByName('aa') `是一个集合，是一组元素，在IE下只对表单元素起作用，对非表单元素不起作用，为了兼容性，最好只用来操作表单元素
-   选择器 在移动端页面用的
-   `document.querySelector()`通过选择器获取到一个元素
-   `document.querySelectorAll()` 通过选择器获取到一组元素 ，元素集合 

### 自定义封装

IE浏览器不支持所有的获取元素的属性，需要自定义方法解决：

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>children</title>
</head>
<body>
<ul id="oUl">
    <li id="li1">11</li>
    <!--注释-->
    <li>222</li>
    asdfasdfafaaaa
    <li id="li3">333</li>
    <li>444</li>
    <li>5555</li>
    <li id="li6">6666</li>
</ul>

<div id="div1">
    <span>asdf</span>
    adfadf
    <p>saa</p>
    <em></em>
</div>
</body>
</html>
<script>
    var oLi1 = document.getElementById("li1");
    var oLi3 = document.getElementById("li3");
    var oLi6 = document.getElementById("li6");
    // var oUl = document.getElementById("oUl");
    var oDiv = document.getElementById("div1");
    /**
     * 获取指定元素的所有元素节点
     *
     * @param ele 指定的元素
     * @returns {Array}  arr 所有子元素节点
     */
    function getChildren(ele) {
        var arr = [];
        var allNodes = ele.childNodes;
        // console.log(allNodes);
        for (var i = 0; i < allNodes.length; i++) {
            if (allNodes[i].nodeType === 1) {
                arr[arr.length] = allNodes[i];
            }
        }
        return arr;
    }

    console.log(getChildren(oDiv));

    /**
     * 获取指定元素的哥哥元素
     *
     * @param ele 指定元素
     * @returns {Object} preEle 哥哥元素
     */
    function getPreEleSibling(ele) {
        var childs = getChildren(ele.parentNode);
        var index = childs.indexOf(ele);
        if (childs.length === 1 || index === 0) {
            return null;
        }
        var preEle = null;
        for (var i = 0; i < childs.length; i++) {
            if (i === index) {
                preEle = childs[i - 1];
                break;
            }
        }
        return preEle;
    }

    console.log("获取哥哥元素:");
    console.log(getPreEleSibling(oLi3));

    /**
     * 获取指定元素的弟弟元素
     *
     * @param ele 指定元素
     * @returns {Object} nextEleSibling 弟弟元素
     */
    function getNextEleSibling(ele) {
        var childs = getChildren(ele.parentNode);
        if (childs.length === 1 || childs.indexOf(ele) === childs.length - 1) {
            return null;
        }
        var nextEleSibling = null;
        for (var i = 0; i < childs.length; i++) {
            if (i === childs.indexOf(ele)) {
                nextEleSibling = childs[i + 1];
                break;
            }
        }
        return nextEleSibling;
    }

    console.log("弟弟元素：");

    console.log(getNextEleSibling(oLi3));

    /**
     * 获取指定元素的所有的哥哥元素
     *
     * @param ele 指定元素
     * @returns {Array} eleSiblings 所有哥哥元素的集合
     */
    function getEleSiblings(ele) {
        var childs = getChildren(ele.parentNode);
        if (childs.length === 1) {
            return null;
        }
        var index = childs.indexOf(ele);
        if (index > 0) {
            var eleSiblings = [];
            for (var i = 0; i < childs.length; i++) {
                if (i < index) {
                    eleSiblings[eleSiblings.length] = childs[i];
                }
            }
        }
        return eleSiblings;
    }

    console.log("获取所有哥哥元素：");
    console.log(getEleSiblings(oLi3));

    /**
     * 获取指定元素的所有的弟弟元素
     *
     * @param ele
     * @returns {Array} nextEleSiblings 所有弟弟元素的集合
     */
    function getNextEleSiblings(ele) {
        var childs = getChildren(ele.parentNode);
        if (childs.length === 1) {
            return null;
        }
        var index = childs.indexOf(ele);
        if (index < childs.length - 1) {
            var nextEleSiblings = [];
            for (var i = 0; i < childs.length; i++) {
                if (i > index) {
                    nextEleSiblings[nextEleSiblings.length] = childs[i];
                }
            }
        }
        return nextEleSiblings;
    }

    console.log("获取所有弟弟元素：");
    console.log(getNextEleSiblings(oLi1));

</script>
```

### 动态操作 DOM 节点（DOM 元素节点）

#### 创建

创建元素

```js
var oDiv = document.createElement("div");
```

创建文本节点

```js
var oText = document.createTextNode("Hello");
```

#### 添加

```js
var oBody = document.body; // 获得body标签
var oHtml = document.docuemntElement;  //获得html标签
oBody.appendChild(oDiv);
oDiv.appendChild(oText);// 一般不这么用  有innerText
```

###  删除

```js
document.removeChild(ele);
```

#### 替换

语义：**先删除，后添加**

```js
document.replaceChild(newEle,oldEle);
```

#### 克隆

```js
ele.cloneNode();
ele.cloneNode(true);
```

>   默认不传参，参数值默认 false,表示浅克隆:只克隆当前元素 ele 及其属性
>
>   传入参数 true,深克隆:克隆 ele 及其后代所有节点，包含非元素节点以及元素节点及其属性

#### 元素节点属性操作

```js
ele.setAttribute(attrName,attrValue);
ele.getAttribute(attrName);
```

>   `ele.setAttribute("class","classValue"); ` IE7及以下浏览器不支持